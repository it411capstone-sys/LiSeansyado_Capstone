
rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {

    // Allow read access to everyone for placeholder images.
    match /receipts/{fileName} {
      allow read: if true;
      allow write: if request.auth != null;
    }

    // Profile Pictures: Allow public read, but only authenticated users can write to their own directory.
    match /profile_pictures/{userId}/{imageName} {
      allow read: if true;
      allow write: if request.auth != null && request.auth.uid == userId;
    }

    // Verification Documents: Only the authenticated user can read or write their own documents.
    match /verification_documents/{userId}/{documentName} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }

    // Registration Photos: Allow any authenticated user to upload registration photos. Allow public read.
    match /registrations/{registrationId}/{imageName} {
      allow read: if true;
      allow write: if request.auth != null;
    }
  }
}
